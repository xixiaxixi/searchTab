# 筛选器优化更新说明

## 概述

本次更新对筛选器进行了重大优化，参考了 Android Studio Logcat 的筛选设计，提供了更强大和灵活的筛选功能。

## 主要更新

### 1. 多标签支持
现在可以在一个筛选表达式中使用多个标签，并支持复杂的逻辑组合。

**规则：**
- **同字段标签 = OR（或）关系**
  - `url:github.io url:gitlab.io` → URL 包含 github.io **或** gitlab.io
  - `title:vue title:react` → 标题包含 vue **或** react

- **不同字段标签 = AND（且）关系**
  - `url:github.com title:vue` → URL 包含 github.com **且** 标题包含 vue
  - `dir:工作 title:项目` → 在"工作"文件夹 **且** 标题包含"项目"

### 2. 负向筛选（排除）
使用 `-` 前缀可以排除匹配的项目。

**示例：**
```
title:新闻 -title:广告 -title:娱乐
```
标题包含"新闻"，但排除包含"广告"或"娱乐"的项目。

```
url:github.com -url:gist
```
GitHub 的链接，但排除 gist。

### 3. 新增 `dir:` 标签
专门用于筛选收藏夹文件夹，支持通配符匹配。

**特性：**
- **仅对收藏夹有效**：历史记录会自动忽略此标签
- **支持通配符**：
  - `*` - 匹配单级路径
  - `**` - 匹配多级路径

**示例：**
```
dir:工作              # 匹配"工作"文件夹
dir:工作/*            # 匹配"工作"的直接子文件夹
dir:工作/**           # 匹配"工作"及所有子文件夹
dir:项目/前端         # 匹配特定路径
```

### 4. 移除旧的收藏夹文件夹设置项
之前单独的"收藏夹文件夹"输入框已被移除，现在统一使用 `dir:` 标签在筛选器中指定。

这样做的好处：
- 统一的筛选语法
- 更灵活的文件夹匹配（支持通配符）
- 可以与其他筛选条件组合

### 5. 强制标签模式
当输入中包含任何带字段的标签（`title:`、`url:`、`dir:`）时，无标签的纯文本会被忽略。

**示例：**
```
title:github foo
```
只会筛选标题包含"github"的项目，`foo` 会被忽略。

### 6. 实时输入验证
在卡片配置界面中，筛选器输入框现在会：
- ✓ 实时验证语法正确性
- ✓ 显示解析后的筛选条件描述
- ✗ 显示具体的错误信息
- 用颜色区分有效/无效状态（绿色边框=有效，红色边框=错误）

## 使用示例

### 基础示例

**查找 GitHub 或 GitLab 的 Vue 项目：**
```
url:github.com url:gitlab.com title:vue
```

**排除测试和示例代码：**
```
title:项目 -title:test -title:demo -title:example
```

### 文件夹筛选

**工作文件夹下的所有书签：**
```
dir:工作/**
```

**开发文件夹的直接子文件夹（不包括更深层级）：**
```
dir:开发/*
```

**特定路径：**
```
dir:项目/前端/Vue
```

### 复杂组合

**工作相关的 GitHub 项目，但排除 fork：**
```
dir:工作/** url:github.com -title:fork
```

**多个技术栈，排除教程：**
```
title:react title:vue title:angular -title:tutorial -title:教程
```

**使用正则表达式：**
```
url:/^https:/ title:/react|vue/i -title:test
```

## 迁移指南

### 如果你之前使用了"收藏夹文件夹"设置

**旧方式：**
- 筛选器：`title:项目`
- 收藏夹文件夹：`工作`

**新方式：**
```
dir:工作 title:项目
```

**如果想匹配子文件夹：**
```
dir:工作/** title:项目
```

### 如果你想保持原有行为

如果你之前不使用文件夹筛选，只需保持原有的筛选表达式即可，完全兼容。

## 注意事项

1. **dir 标签仅对收藏夹有效**：如果卡片同时包含收藏夹和历史记录，dir 只会筛选收藏夹部分
2. **通配符仅限 dir**：`*` 和 `**` 只能在 `dir:` 标签中使用
3. **正则表达式仍然支持**：在任何标签中都可以使用 `/regex/` 格式
4. **不区分大小写**：默认的文本匹配不区分大小写（除非在正则中指定）

## 完整文档

详细的语法说明和更多示例请参考 [FILTER_SYNTAX.md](./FILTER_SYNTAX.md)

## 反馈

如有问题或建议，欢迎提交 Issue！
